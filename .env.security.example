# Security Environment Variables

## Rate Limiting Configuration
# Override default rate limits for different endpoints
# Values are in requests per time window

# Global rate limiting (applies to all routes unless overridden)
SECURITY_GLOBAL_RATE_LIMIT_REQUESTS=100
SECURITY_GLOBAL_RATE_LIMIT_WINDOW_MS=900000  # 15 minutes

# API endpoints rate limiting
SECURITY_API_RATE_LIMIT_REQUESTS=50
SECURITY_API_RATE_LIMIT_WINDOW_MS=900000     # 15 minutes

# Authentication endpoints (login, etc.)
SECURITY_AUTH_RATE_LIMIT_REQUESTS=5
SECURITY_AUTH_RATE_LIMIT_WINDOW_MS=900000    # 15 minutes

# Contact form submissions
SECURITY_CONTACT_RATE_LIMIT_REQUESTS=3
SECURITY_CONTACT_RATE_LIMIT_WINDOW_MS=3600000 # 1 hour

## CSRF Protection
SECURITY_CSRF_ENABLED=true
SECURITY_CSRF_TOKEN_LENGTH=32
SECURITY_CSRF_COOKIE_NAME=khesed-csrf-token
SECURITY_CSRF_HEADER_NAME=x-csrf-token

## CORS Configuration
# Comma-separated list of allowed origins
SECURITY_CORS_ORIGINS=https://khesedtek.com,https://www.khesedtek.com

## Security Headers
SECURITY_CSP_ENABLED=true
SECURITY_HSTS_ENABLED=true
SECURITY_NO_SNIFF_ENABLED=true
SECURITY_FRAME_OPTIONS_ENABLED=true
SECURITY_XSS_PROTECTION_ENABLED=true

## Development Mode
# Set to 'true' to relax some security restrictions for development
SECURITY_DEVELOPMENT_MODE=false

## Monitoring and Alerts
# Email for security alert notifications
SECURITY_ADMIN_EMAIL=admin@khesedtek.com

# Webhook URL for security events (optional)
SECURITY_WEBHOOK_URL=

## IP Blocking
# Duration to block IPs showing suspicious behavior (in milliseconds)
SECURITY_IP_BLOCK_DURATION=900000  # 15 minutes

# Maximum number of audit logs to keep in memory
SECURITY_MAX_AUDIT_LOGS=1000

## Custom Security Rules
# Enable/disable specific abuse detection rules
SECURITY_RAPID_FIRE_DETECTION=true
SECURITY_PERSISTENT_LIMIT_DETECTION=true

# Additional patterns to block in User-Agent header (comma-separated)
SECURITY_BLOCKED_USER_AGENTS=

# Additional legitimate bot patterns to allow (comma-separated)
SECURITY_ALLOWED_BOTS=